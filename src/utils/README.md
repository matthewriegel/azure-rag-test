# Utilities

Helper functions for logging, tokenization, hashing, normalization, PII redaction, and retry logic.

## Modules

### Logger (`logger.ts`)
Winston-based structured logger with timestamp and JSON formatting.

```typescript
import logger from './utils/logger';

logger.info('Message', { key: 'value' });
logger.error('Error occurred', { error });
```

### Tokenizer (`tokenizer.ts`)
Token counting, text chunking, and truncation using tiktoken (cl100k_base).

```typescript
import { countTokens, chunkText, truncateText } from './utils/tokenizer';

const tokens = countTokens('text');
const chunks = chunkText('long text', 500, 100); // size, overlap
const truncated = truncateText('text', 100); // max tokens
```

### Helpers (`helpers.ts`)
Hashing, query normalization, PII redaction, retry logic.

```typescript
import { createCacheKey, normalizeQuery, redactPII, retryWithBackoff } from './utils/helpers';

const key = createCacheKey(query, customerId);
const normalized = normalizeQuery('  What IS the EMAIL? '); // "what is the email?"
const redacted = redactPII('My SSN is 123-45-6789'); // "My SSN is [REDACTED]"
await retryWithBackoff(() => apiCall(), 3, 1000);
```

## File Pointers

- `src/utils/logger.ts` - Winston logger
- `src/utils/tokenizer.ts` - Tiktoken wrapper
- `src/utils/helpers.ts` - General utilities
- `src/utils/index.ts` - Exports

---

**Last updated**: 2026-02-01T15:38:00Z  
**Author**: Generated by Copilot action prompt; review recommended
